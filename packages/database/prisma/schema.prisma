// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider   = "prisma-client-js"
  output     = "../.prisma/client"
  engineType = "binary"
}

datasource db {
  provider = "postgresql"
  url      = env("POSTGRES_URL")
}

model Node {
  nodeID     String @id
  xcoord     Int
  ycoord     Int
  floor      String
  building   String
  nodeType   String
  longName   String
  shortName  String
  startEdges Edge[] @relation("StartNode")
  endEdges   Edge[] @relation("EndNode")
}

model Edge {
  edgeID      String @id
  startNode   Node   @relation("StartNode", fields: [startNodeID], references: [nodeID])
  startNodeID String
  endNode     Node   @relation("EndNode", fields: [endNodeID], references: [nodeID])
  endNodeID   String
}

model ServiceRequest {
  serviceID         Int                       @id @default(autoincrement())
  timeCreated       DateTime                  @default(now())
  createdBy         Employee                  @relation("Created", fields: [createdByID], references: [email])
  createdByID       String
  locationID        String
  priority          String
  status            String
  assignedTo        Employee?                 @relation("Assigned", fields: [assignedID], references: [email])
  assignedID        String?
  notes             String
  sanitation        SanitationRequest?
  maintenance       MaintenanceRequest?
  internalTransport InternalTransportRequest?
  medicine          MedicineRequest?
  language          LanguageRequest?
}

model SanitationRequest {
  sanitationID   Int            @id @default(autoincrement())
  serviceRequest ServiceRequest @relation(fields: [serviceID], references: [serviceID])
  serviceID      Int            @unique
  hazards        String
}

model MaintenanceRequest {
  maintenanceID  Int            @id @default(autoincrement())
  serviceRequest ServiceRequest @relation(fields: [serviceID], references: [serviceID])
  serviceID      Int            @unique
  details        String
}

model InternalTransportRequest {
  internalTransportID Int            @id @default(autoincrement())
  serviceRequest      ServiceRequest @relation(fields: [serviceID], references: [serviceID])
  serviceID           Int            @unique
  toLocation          String
  mobilityAid         String
  patientName         String
}

model MedicineRequest {
  medicineID     Int            @id @default(autoincrement())
  serviceRequest ServiceRequest @relation(fields: [serviceID], references: [serviceID])
  serviceID      Int            @unique
  medicineType   String
  amount         String
}

model LanguageRequest {
  languageID     Int            @id @default(autoincrement())
  serviceRequest ServiceRequest @relation(fields: [serviceID], references: [serviceID])
  serviceID      Int            @unique
  language1      String
  language2      String
  when           DateTime
}

model Employee {
  email            String           @id
  firstName        String?
  lastName         String?
  requestsCreated  ServiceRequest[] @relation("Created")
  requestsAssigned ServiceRequest[] @relation("Assigned")
}
